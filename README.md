# Analyze-PE ‚Äî –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä PE-—Ñ–∞–π–ª–æ–≤ (EXE/DLL)

–ë—ã—Å—Ç—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è PE-—Ñ–∞–π–ª–æ–≤ –Ω–∞ Go. –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–∞, –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä –∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üìä –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: —Ö—ç—à–∏ (SHA256, SSDEEP), —Ä–∞–∑–º–µ—Ä, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- üì¶ –°–µ–∫—Ü–∏–∏: –∏–º–µ–Ω–∞, —Ä–∞–∑–º–µ—Ä—ã, —ç–Ω—Ç—Ä–æ–ø–∏—è, —Ñ–ª–∞–≥–∏
- üìö –ò–º–ø–æ—Ä—Ç—ã: DLL –∏ —Ñ—É–Ω–∫—Ü–∏–∏
- üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: —Ç–∏–ø –∏ –≤–µ—Ä—Å–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–∞
- üìÑ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫: ASCII –∏ UTF-16LE

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/Sccrap/analyze-pe.git
cd analyze-pe
go build -o analyzer
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
./analyzer --web              # –û—Ç–∫—Ä–æ–µ—Ç—Å—è http://localhost:8080
./analyzer -w                 # –ö–æ—Ä–æ—Ç–∫–∏–π —Ñ–ª–∞–≥

# –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (CLI)
./analyzer file.exe

# –° –æ–ø—Ü–∏—è–º–∏ (CLI)
./analyzer -b file.exe        # SHA256, —Ä–∞–∑–º–µ—Ä, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
./analyzer -s file.exe        # –°–µ–∫—Ü–∏–∏ –∏ —ç–Ω—Ç—Ä–æ–ø–∏—è
./analyzer -i file.exe        # –ò–º–ø–æ—Ä—Ç—ã
./analyzer -d file.exe        # –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
./analyzer -x file.exe        # –ò–∑–≤–ª–µ—á—å —Å—Ç—Ä–æ–∫–∏ –≤ stdout
./analyzer -x file.exe out.txt # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–∞–π–ª
```

---

## üåê –í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ PE-—Ñ–∞–π–ª–æ–≤:

```bash
./analyzer --web
```

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è: **http://localhost:8080**

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:**
- üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É
- üéØ –ö–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- üìä –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- üé® –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π
- ‚úì –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –ª—é–±–æ–π –û–°

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ (Windows, macOS, Linux)
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—Ç–æ–ª—å–∫–æ Go)
- ‚úÖ –ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞
- ‚úÖ –õ–µ–≥–∫–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è

---

## üìñ –ö–æ–º–∞–Ω–¥—ã

| –§–ª–∞–≥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|
| `-h, --help` | –°–ø—Ä–∞–≤–∫–∞ |
| `-w, --web` | –í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (http://localhost:8080) |
| `-b, --basic` | –•—ç—à–∏, —Ä–∞–∑–º–µ—Ä, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∫–æ–ª-–≤–æ —Å–µ–∫—Ü–∏–π |
| `-s, --sections` | –°–µ–∫—Ü–∏–∏, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã, —ç–Ω—Ç—Ä–æ–ø–∏—è |
| `-i, --imports` | –¢–∞–±–ª–∏—Ü–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ (DLL ‚Üí —Ñ—É–Ω–∫—Ü–∏–∏) |
| `-d, --debug` | –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (CodeView, PDB, PGO) |
| `-x, --strings` | –ò–∑–≤–ª–µ—á—å ASCII/UTF-16LE —Å—Ç—Ä–æ–∫–∏ |

**–ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞:**

```bash
$ ./analyzer -b malware.exe
Basic info for malware.exe:
--------------------------------------
File size:   512000 bytes
Machine:     x86 (Intel 80386)
SHA256:      a1b2c3d4...
SSDEEP:      12288:ABC...
Sections:    3
--------------------------------------
```

```bash
$ ./analyzer -s malware.exe
Successfully parsed malware.exe
Number of sections: 3
Section Name: .text
  VirtualSize: 0x4000
  Characteristics: 0x60000020
  Entropy: 7.234

Section Name: .data
  VirtualSize: 0x1000
  Characteristics: 0xc0000040
  Entropy: 2.145
```

```bash
$ ./analyzer -d malware.exe
Debug info for malware.exe:
--------------------------------------
Number of debug entries: 1

Debug Entry 1:
  Type:              IMAGE_DEBUG_TYPE_CODEVIEW
  Characteristics:   0x0
  TimeDateStamp:     1234567890 (0x499602d2)
  MajorVersion:      20
  MinorVersion:      0
  PointerToRawData:  0x1000
  SizeOfData:        200 bytes
  AddressOfRawData:  0x5000
  -> CodeView (PDB) format detected
--------------------------------------
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:** PE32 (x86), PE32+ (x64)

**–û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞:** [`github.com/saferwall/pe`](https://github.com/saferwall/pe)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç PE —Ñ–∞–π–ª (`pe.New()`)
2. –ü–∞—Ä—Å–∏—Ç –≤—Å–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: DOS Header ‚Üí NT Header ‚Üí —Å–µ–∫—Ü–∏–∏ ‚Üí –∏–º–ø–æ—Ä—Ç—ã/–æ—Ç–ª–∞–¥–∫–∞
3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: –≤—ã—á–∏—Å–ª—è–µ—Ç —ç–Ω—Ç—Ä–æ–ø–∏—é, —Ö—ç—à–∏, —Å—Ç—Ä–æ–∫–∏
4. –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.18+
- macOS / Linux / Windows

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
go mod tidy
```

---

## ÔøΩ GitHub Actions: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ —Ä–µ–ª–∏–∑–æ–≤

–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å


‚ö†Ô∏è –ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–∞:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é VM –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- –ù–µ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–π—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –≤–Ω–µ –ø–µ—Å–æ—á–Ω–∏—Ü—ã
- –£—Ç–∏–ª–∏—Ç–∞ —Ç–æ–ª—å–∫–æ **—á–∏—Ç–∞–µ—Ç** —Ñ–∞–π–ª—ã, –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–º. —Ñ–∞–π–ª `LICENSE`

---

## ü§ù –í–∫–ª–∞–¥

Suggestions & PRs –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! –°–æ–∑–¥–∞–≤–∞–π—Ç–µ issues –∏ pull requests.
